<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Spectrum Mental Health - Patient Management
  </title>
  <link href="index.css" rel="stylesheet"/>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1>
     Spectrum Mental Health
    </h1>
    <p>
     Patient Management System - Miami, FL
    </p>
    <div class="user-info" id="userInfo" style="margin-top: 10px; font-size: 0.9em; opacity: 0.9;">
     <!-- User info will be displayed here -->
    </div>
   </div>
   <div class="nav">
    <button class="nav-btn active" onclick="showSection('calendar-section')">
     Calendar
    </button>
    <button class="nav-btn" onclick="showSection('add-patient')">
     Add Patient
    </button>
    <button class="nav-btn" onclick="showSection('patient-log')">
     Patient Log
    </button>
    <button class="nav-btn" onclick="showSection('user-management')">
     Manage Users
    </button>
    <button class="nav-btn" id="servicesNavBtn" onclick="showSection('services')">
     Services
    </button>
    <button class="nav-btn logout-btn" onclick="logout()" style="background: rgba(255, 99, 99, 0.3);">
     Logout
    </button>
   </div>
   <!-- Calendar Section -->
   <div class="section active" id="calendar-section">
    <h2>
     Calendar
    </h2>
    <div id="calendarContainer">
    </div>
   </div>
   <!-- Add Patient Section -->
   <div class="section" id="add-patient">
    <h2>
     Add New Patient
    </h2>
    <div class="hipaa-notice">
     <strong>
      HIPAA Notice:
     </strong>
     All patient information is confidential and protected under HIPAA regulations. Access is restricted to authorized personnel only.
    </div>
    <div id="add-alert">
    </div>
    <form id="patientForm">
     <div class="form-row-2">
      <div class="form-group">
       <label for="patientNumber">
        Patient Number
        <span class="required">
         *
        </span>
       </label>
       <input id="patientNumber" name="patient_number" placeholder="e.g., PT001A" required="" type="text"/>
      </div>
      <div class="form-group">
       <label for="session">
        Session
        <span class="required">
         *
        </span>
       </label>
       <select id="session" name="session" required="">
        <option value="">
         Select Session
        </option>
        <option value="AM">
         AM Session
        </option>
        <option value="PM">
         PM Session
        </option>
       </select>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="firstName">
        First Name
        <span class="required">
         *
        </span>
       </label>
       <input id="firstName" name="first_name" required="" type="text"/>
      </div>
      <div class="form-group">
       <label for="lastName">
        Last Name
        <span class="required">
         *
        </span>
       </label>
       <input id="lastName" name="last_name" required="" type="text"/>
      </div>
     </div>
     <div class="form-group">
      <label for="address">
       Address
      </label>
      <input id="address" name="address" placeholder="Full address including city, state, zip" type="text"/>
     </div>
     <div class="form-row-3">
      <div class="form-group">
       <label for="dateOfBirth">
        Date of Birth
       </label>
       <input id="dateOfBirth" name="date_of_birth" type="date"/>
      </div>
      <div class="form-group">
       <label for="phone">
        Phone Number
       </label>
       <input id="phone" name="phone" placeholder="(305) 555-0123" type="tel"/>
      </div>
      <div class="form-group">
       <label for="ssn">
        SSN
       </label>
       <input id="ssn" maxlength="11" name="ssn" placeholder="XXX-XX-XXXX" type="text"/>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="medicaidId">
        Medicaid ID
       </label>
       <input id="medicaidId" name="medicaid_id" type="text"/>
      </div>
      <div class="form-group">
       <label for="insurance">
        Insurance
       </label>
       <select id="insurance" name="insurance">
        <option value="">
         Select Insurance
        </option>
        <option value="Medicaid">
         Medicaid
        </option>
        <option value="Medicare">
         Medicare
        </option>
        <option value="Aetna">
         Aetna
        </option>
        <option value="Blue Cross Blue Shield">
         Blue Cross Blue Shield
        </option>
        <option value="Humana">
         Humana
        </option>
        <option value="UnitedHealthcare">
         UnitedHealthcare
        </option>
        <option value="Other">
         Other
        </option>
       </select>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="insuranceId">
        Insurance ID
       </label>
       <input id="insuranceId" name="insurance_id" type="text"/>
      </div>
      <div class="form-group">
       <label for="referal">
        Referal
       </label>
       <input id="referal" name="referal" placeholder="Who referred this patient?" type="text"/>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="psrDate">
        PSR Date
       </label>
       <input id="psrDate" name="psr_date" type="date"/>
      </div>
      <div class="form-group">
       <label for="authorization">
        Authorization
       </label>
       <input id="authorization" name="authorization" placeholder="Authorization details" type="text"/>
      </div>
     </div>
     <div class="form-group">
      <label for="diagnosis">
       Diagnosis
      </label>
      <input id="diagnosis" name="diagnosis" placeholder="Diagnosis codes and description" type="text"/>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="startDate">
        Start Date
       </label>
       <input id="startDate" name="start_date" type="date"/>
      </div>
      <div class="form-group">
       <label for="endDate">
        End Date
       </label>
       <input id="endDate" name="end_date" type="date"/>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="code1">
        Code 1
       </label>
       <input id="code1" name="code1" placeholder="e.g., A3329(1)" type="text"/>
      </div>
      <div class="form-group">
       <label for="code2">
        Code 2
       </label>
       <input id="code2" name="code2" placeholder="e.g., B1234(2)" type="text"/>
      </div>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="code3">
        Code 3
       </label>
       <input id="code3" name="code3" placeholder="e.g., C5678(3)" type="text"/>
      </div>
      <div class="form-group">
       <label for="code4">
        Code 4
       </label>
       <input id="code4" name="code4" placeholder="e.g., D9876(4)" type="text"/>
      </div>
     </div>
     <button class="btn" type="submit">
      Add Patient
     </button>
    </form>
   </div>
   <!-- Patient Log Section -->
   <div class="section" id="patient-log">
    <div id="patient-list-view">
     <h2>
      Patient Log
     </h2>
     <input class="search-box" id="searchBox" placeholder="Search by patient number, name, or phone..." type="text"/>
     <div class="loading" id="loading" style="display: none;">
      Loading patients...
     </div>
     <div class="patients-grid" id="patientsContainer">
      <!-- Patient cards will be inserted here -->
     </div>
    </div>
    <!-- Edit Patient Form (Hidden by default) -->
    <div id="patient-edit-view" style="display: none;">
     <h2>
      Edit Patient Information
     </h2>
     <div class="hipaa-notice">
      <strong>
       Notice:
      </strong>
      You are editing patient information. All changes will be logged and tracked.
     </div>
     <div id="edit-alert">
     </div>
     <form id="editPatientForm">
      <input id="editPatientId" name="patient_id" type="hidden"/>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editPatientNumber">
         Patient Number
         <span class="required">
          *
         </span>
        </label>
        <input id="editPatientNumber" name="patient_number" required="" type="text"/>
       </div>
       <div class="form-group">
        <label for="editSession">
         Session
         <span class="required">
          *
         </span>
        </label>
        <select id="editSession" name="session" required="">
         <option value="">
          Select Session
         </option>
         <option value="AM">
          AM Session
         </option>
         <option value="PM">
          PM Session
         </option>
        </select>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editFirstName">
         First Name
         <span class="required">
          *
         </span>
        </label>
        <input id="editFirstName" name="first_name" required="" type="text"/>
       </div>
       <div class="form-group">
        <label for="editLastName">
         Last Name
         <span class="required">
          *
         </span>
        </label>
        <input id="editLastName" name="last_name" required="" type="text"/>
       </div>
      </div>
      <div class="form-group">
       <label for="editAddress">
        Address
       </label>
       <input id="editAddress" name="address" placeholder="Full address including city, state, zip" type="text"/>
      </div>
      <div class="form-row-3">
       <div class="form-group">
        <label for="editDateOfBirth">
         Date of Birth
        </label>
        <input id="editDateOfBirth" name="date_of_birth" type="date"/>
       </div>
       <div class="form-group">
        <label for="editPhone">
         Phone Number
        </label>
        <input id="editPhone" name="phone" placeholder="(305) 555-0123" type="tel"/>
       </div>
       <div class="form-group">
        <label for="editSsn">
         SSN
        </label>
        <input id="editSsn" maxlength="11" name="ssn" placeholder="XXX-XX-XXXX" type="text"/>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editMedicaidId">
         Medicaid ID
        </label>
        <input id="editMedicaidId" name="medicaid_id" type="text"/>
       </div>
       <div class="form-group">
        <label for="editInsurance">
         Insurance
        </label>
        <select id="editInsurance" name="insurance">
         <option value="">
          Select Insurance
         </option>
         <option value="Medicaid">
          Medicaid
         </option>
         <option value="Medicare">
          Medicare
         </option>
         <option value="Aetna">
          Aetna
         </option>
         <option value="Blue Cross Blue Shield">
          Blue Cross Blue Shield
         </option>
         <option value="Humana">
          Humana
         </option>
         <option value="UnitedHealthcare">
          UnitedHealthcare
         </option>
         <option value="Other">
          Other
         </option>
        </select>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editInsuranceId">
         Insurance ID
        </label>
        <input id="editInsuranceId" name="insurance_id" type="text"/>
       </div>
       <div class="form-group">
        <label for="editReferal">
         Referal
        </label>
        <input id="editReferal" name="referal" placeholder="Who referred this patient?" type="text"/>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editPsrDate">
         PSR Date
        </label>
        <input id="editPsrDate" name="psr_date" type="date"/>
       </div>
       <div class="form-group">
        <label for="editAuthorization">
         Authorization
        </label>
        <input id="editAuthorization" name="authorization" placeholder="Authorization details" type="text"/>
       </div>
      </div>
      <div class="form-group">
       <label for="editDiagnosis">
        Diagnosis
       </label>
       <input id="editDiagnosis" name="diagnosis" placeholder="Diagnosis codes and description" type="text"/>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editStartDate">
         Start Date
        </label>
        <input id="editStartDate" name="start_date" type="date"/>
       </div>
       <div class="form-group">
        <label for="editEndDate">
         End Date
        </label>
        <input id="editEndDate" name="end_date" type="date"/>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editCode1">
         Code 1
        </label>
        <input id="editCode1" name="code1" placeholder="e.g., A3329(1)" type="text"/>
       </div>
       <div class="form-group">
        <label for="editCode2">
         Code 2
        </label>
        <input id="editCode2" name="code2" placeholder="e.g., B1234(2)" type="text"/>
       </div>
      </div>
      <div class="form-row-2">
       <div class="form-group">
        <label for="editCode3">
         Code 3
        </label>
        <input id="editCode3" name="code3" placeholder="e.g., C5678(3)" type="text"/>
       </div>
       <div class="form-group">
        <label for="editCode4">
         Code 4
        </label>
        <input id="editCode4" name="code4" placeholder="e.g., D9876(4)" type="text"/>
       </div>
      </div>
      <div style="margin-top: 30px;">
       <button class="btn" type="submit">
        Update Patient
       </button>
       <button class="btn btn-danger" onclick="cancelEdit()" style="margin-left: 15px;" type="button">
        Back to Patient List
       </button>
      </div>
     </form>
    </div>
   </div>
   <!-- User Management Section -->
   <div class="section" id="user-management">
    <div id="user-list-view">
     <h2>
      Manage Users
     </h2>
     <p style="margin-bottom: 20px; color: #666;">
      Create and manage user accounts for the system. All users have the same access level.
     </p>
     <div style="margin-bottom: 20px;">
      <button class="btn btn-success" onclick="showAddUserModal()">
       Add New User
      </button>
     </div>
     <input class="search-box" id="userSearchBox" placeholder="Search users by name, username, or email..." type="text"/>
     <div class="loading" id="userLoading" style="display: none;">
      Loading users...
     </div>
     <div class="users-grid" id="usersContainer">
      <!-- User cards will be inserted here -->
     </div>
    </div>
   </div>
   <!-- Services Section -->
   <div class="section" id="services">
    <h2 style="text-align:center;">Services</h2>
    <div style="margin-top:30px; display:flex; gap:24px; flex-wrap:wrap; justify-content:center; align-items:center;">
     <button class="btn btn-service" style="min-width:180px;" onclick="openServiceForm('TMS')">TMS</button>
     <button class="btn btn-service" style="min-width:180px;" onclick="openServiceForm('PSR')">PSR</button>
     <button class="btn btn-service" style="min-width:180px;" onclick="openServiceForm('Individual Therapy')">Individual Therapy</button>
     <button class="btn btn-service" style="min-width:180px;" onclick="openServiceForm('Evaluations')">Evaluations</button>
    </div>
    <div style="color:#888; font-style:italic; margin-top:32px; text-align:center;">Select a service to continue.</div>
   </div>

   <!-- Service Entry Modal -->
   <div class="modal" id="serviceEntryModal" style="display:none;">
    <div class="modal-content" style="max-width:420px;">
     <div class="modal-header">
      <h2 id="serviceFormTitle">Add Service Entry</h2>
      <span class="close" onclick="closeServiceEntryModal()">×</span>
     </div>
     <form id="serviceEntryForm" onsubmit="submitServiceEntry(event)">
      <div class="form-group">
       <label for="servicePatientSearch">Patient Name <span class="required">*</span></label>
       <input id="servicePatientSearch" name="patient_name" type="text" placeholder="Search patient..." autocomplete="off" required oninput="searchPatientNames(this.value)">
       <div id="servicePatientSuggestions" class="autocomplete-suggestions"></div>
      </div>
      <div class="form-group">
       <label for="serviceDate">Date of Service <span class="required">*</span></label>
       <input id="serviceDate" name="service_date" type="date" required>
      </div>
      <div class="form-group">
       <label for="serviceTime">Time of Service <span class="required">*</span></label>
       <select id="serviceTime" name="service_time" required>
        <option value="09:00">9:00 AM</option>
        <option value="09:15">9:15 AM</option>
        <option value="09:30">9:30 AM</option>
        <option value="09:45">9:45 AM</option>
        <option value="10:00">10:00 AM</option>
        <option value="10:15">10:15 AM</option>
        <option value="10:30">10:30 AM</option>
        <option value="10:45">10:45 AM</option>
        <option value="11:00">11:00 AM</option>
        <option value="11:15">11:15 AM</option>
        <option value="11:30">11:30 AM</option>
        <option value="11:45">11:45 AM</option>
        <option value="12:00">12:00 PM</option>
        <option value="12:15">12:15 PM</option>
        <option value="12:30">12:30 PM</option>
        <option value="12:45">12:45 PM</option>
        <option value="13:00">1:00 PM</option>
        <option value="13:15">1:15 PM</option>
        <option value="13:30">1:30 PM</option>
        <option value="13:45">1:45 PM</option>
        <option value="14:00">2:00 PM</option>
        <option value="14:15">2:15 PM</option>
        <option value="14:30">2:30 PM</option>
        <option value="14:45">2:45 PM</option>
        <option value="15:00">3:00 PM</option>
        <option value="15:15">3:15 PM</option>
        <option value="15:30">3:30 PM</option>
        <option value="15:45">3:45 PM</option>
        <option value="16:00">4:00 PM</option>
        <option value="16:15">4:15 PM</option>
        <option value="16:30">4:30 PM</option>
        <option value="16:45">4:45 PM</option>
        <option value="17:00">5:00 PM</option>
       </select>
      </div>
      <div class="form-group">
       <label for="serviceSheetType">Sheet Type <span class="required">*</span></label>
       <select id="serviceSheetType" name="sheet_type" required>
        <option value="attendance">Attendance Sheet</option>
        <option value="appointment">Appointment Sheet</option>
       </select>
      </div>
      <input id="serviceType" name="service_type" type="hidden">
      <input id="servicePatientId" name="patient_id" type="hidden">
      <div style="margin-top:20px; text-align:right;">
       <button class="btn" type="submit">Add Service</button>
       <button class="btn btn-danger" type="button" onclick="closeServiceEntryModal()" style="margin-left:12px;">Cancel</button>
      </div>
     </form>
    </div>
   </div>
 <!-- New Sheet Modal for Attendance/Appointment -->
 <div class="modal" id="sheetModal" style="display:none; z-index: 1200;">
  <div class="modal-content" style="max-width:600px;">
   <div class="modal-header">
    <h2 id="sheetModalTitle">Sheet Entries</h2>
    <span class="close" onclick="closeSheetModal()">×</span>
   </div>
   <div id="sheetEntriesContainer">
    <!-- Sheet entries will be loaded here -->
   </div>
  </div>
 </div>
  <!-- Add User Modal -->
  <div class="modal" id="addUserModal">
   <div class="modal-content">
    <div class="modal-header">
     <h2>
      Add New User
     </h2>
     <span class="close" onclick="closeAddUserModal()">
      ×
     </span>
    </div>
    <div id="addUserAlert">
    </div>
    <form id="addUserForm">
     <div class="form-row-2">
      <div class="form-group">
       <label for="newUsername">
        Username
        <span class="required">
         *
        </span>
       </label>
       <input id="newUsername" name="username" placeholder="Enter username" required="" type="text"/>
      </div>
      <div class="form-group">
       <label for="newEmail">
        Email
        <span class="required">
         *
        </span>
       </label>
       <input id="newEmail" name="email" placeholder="user@example.com" required="" type="email"/>
      </div>
     </div>
     <div class="form-group">
      <label for="newFullName">
       Full Name
       <span class="required">
        *
       </span>
      </label>
      <input id="newFullName" name="full_name" placeholder="Enter full name" required="" type="text"/>
     </div>
     <div class="form-row-2">
      <div class="form-group">
       <label for="newRole">
        Role
        <span class="required">
         *
        </span>
       </label>
       <select id="newRole" name="role" required="">
        <option value="">
         Select Role
        </option>
        <option value="staff">
         Staff Member
        </option>
        <option value="admin">
         Administrator
        </option>
       </select>
      </div>
      <div class="form-group">
       <label for="newPassword">
        Password
        <span class="required">
         *
        </span>
       </label>
       <input id="newPassword" name="password" placeholder="Minimum 8 characters" required="" type="password"/>
      </div>
     </div>
     <div style="margin-top: 20px;">
      <button class="btn" type="submit">
       Create User
      </button>
      <button class="btn btn-danger" onclick="closeAddUserModal()" style="margin-left: 15px;" type="button">
       Cancel
      </button>
     </div>
    </form>
   </div>
  </div>
  <!-- Reset Password Modal -->
  <div class="modal" id="resetPasswordModal">
   <div class="modal-content">
    <div class="modal-header">
     <h2>
      Reset Password
     </h2>
     <span class="close" onclick="closeResetPasswordModal()">
      ×
     </span>
    </div>
    <div id="resetPasswordAlert">
    </div>
    <form id="resetPasswordForm">
     <input id="resetUserId" type="hidden"/>
     <p>
      Reset password for:
      <strong id="resetUserName">
      </strong>
     </p>
     <div class="form-group" style="margin-top: 20px;">
      <label for="resetNewPassword">
       New Password
       <span class="required">
        *
       </span>
      </label>
      <input id="resetNewPassword" name="new_password" placeholder="Minimum 8 characters" required="" type="password"/>
     </div>
     <div style="margin-top: 20px;">
      <button class="btn" type="submit">
       Reset Password
      </button>
      <button class="btn btn-danger" onclick="closeResetPasswordModal()" style="margin-left: 15px;" type="button">
       Cancel
      </button>
     </div>
    </form>
   </div>
  </div>
  <!-- Patient View Modal -->
  <div class="modal" id="patientModal">
   <div class="modal-content">
    <div class="modal-header">
     <h2>
      Patient Information
     </h2>
     <span class="close" onclick="closePatientModal()">
      ×
     </span>
    </div>
    <div id="modalPatientInfo">
     <!-- Patient info will be loaded here -->
     <div style="margin-top: 20px; text-align:center;">
      <button class="btn btn-service" id="attendanceSheetBtn" style="margin-right:12px;" onclick="showSheetModal('attendance')">Attendance Sheet</button>
      <button class="btn btn-service" id="appointmentSheetBtn" onclick="showSheetModal('appointment')">Appointment Sheet</button>
     </div>
    </div>
   </div>
  </div>
  <!-- Main Modal for dynamic content -->
  <div class="modal" id="mainModal" style="display:none;">
    <div class="modal-content">
      <span class="close" id="mainModalClose">&times;</span>
      <h2 id="mainModalTitle"></h2>
      <div id="mainModalBody"></div>
    </div>
  </div>
  <script src="index.js">
  </script>
 </body>
</html>